NVIDIA A100-SXM4-40GB 3
{'dataset_name': 'AqSol', 'basis': 'GSO', 'epsilon': [-0.1, -0.2, -0.3, -0.4, -0.5], 'power': [[4, 4], [4, 4], [4, 4], [4, 4], [4, 4]], 'seeds': [0, 1, 2, 3, 4], 'num_workers': 4, 'hyperparams': {'batch_size': 64, 'epochs': 351, 'learning_rate': 0.001, 'decay_rate': 0.6, 'milestones': [40, 75, 110, 145, 180, 215, 250, 305, 340], 'weight_decay': 5e-05, 'warmup_epochs': 5}, 'architecture': {'layers': 6, 'hidden': 160, 'pooling': 'M'}, 'commit_id': '2bb98bab016a2c01cd9aa45c5183c52c98945aa6', 'time_stamp': '1673276112', 'directory': '../../../results_spectral_rotation/A100_relu_zinc/AqSol/'}
{'dataset_name': 'AqSol', 'basis': 'GSO', 'epsilon': [-0.1, -0.2, -0.3, -0.4, -0.5], 'power': [[4, 4], [4, 4], [4, 4], [4, 4], [4, 4]], 'seeds': [0, 1, 2, 3, 4], 'num_workers': 4, 'hyperparams': {'batch_size': 64, 'epochs': 351, 'learning_rate': 0.001, 'decay_rate': 0.6, 'milestones': [40, 75, 110, 145, 180, 215, 250, 305, 340], 'weight_decay': 5e-05, 'warmup_epochs': 5}, 'architecture': {'layers': 6, 'hidden': 160, 'pooling': 'M'}, 'commit_id': '2bb98bab016a2c01cd9aa45c5183c52c98945aa6', 'time_stamp': 1673276114, 'directory': '../../../results_spectral_rotation/A100_relu_zinc/AqSol/', 'seed': 0}
Basis configurations: basis: GSO, epsilon: [-0.1, -0.2, -0.3, -0.4, -0.5], power: [[4, 4], [4, 4], [4, 4], [4, 4], [4, 4]], degs: []
Generating 7985 graphs for the TRAIN set...
Pre-processing:   0%|          | 0/7985 [00:00<?, ?it/s]Pre-processing:   1%|          | 77/7985 [00:00<00:10, 767.20it/s]Pre-processing:   2%|▏         | 160/7985 [00:00<00:09, 799.62it/s]Pre-processing:   3%|▎         | 240/7985 [00:00<00:09, 794.00it/s]Pre-processing:   4%|▍         | 321/7985 [00:00<00:09, 799.67it/s]Pre-processing:   5%|▌         | 401/7985 [00:00<00:09, 795.29it/s]Pre-processing:   6%|▌         | 488/7985 [00:00<00:09, 818.10it/s]Pre-processing:   7%|▋         | 572/7985 [00:00<00:08, 824.42it/s]Pre-processing:   8%|▊         | 655/7985 [00:00<00:09, 786.62it/s]Pre-processing:   9%|▉         | 737/7985 [00:00<00:09, 793.40it/s]Pre-processing:  10%|█         | 819/7985 [00:01<00:08, 798.51it/s]Pre-processing:  11%|█▏        | 904/7985 [00:01<00:08, 812.60it/s]Pre-processing:  12%|█▏        | 989/7985 [00:01<00:08, 823.11it/s]Pre-processing:  13%|█▎        | 1072/7985 [00:01<00:08, 818.62it/s]Pre-processing:  14%|█▍        | 1154/7985 [00:01<00:08, 809.75it/s]Pre-processing:  15%|█▌        | 1236/7985 [00:01<00:08, 809.11it/s]Pre-processing:  17%|█▋        | 1318/7985 [00:01<00:08, 812.14it/s]Pre-processing:  18%|█▊        | 1400/7985 [00:01<00:09, 677.81it/s]Pre-processing:  19%|█▊        | 1492/7985 [00:01<00:08, 739.03it/s]Pre-processing:  20%|█▉        | 1582/7985 [00:02<00:08, 780.84it/s]Pre-processing:  21%|██        | 1663/7985 [00:02<00:08, 780.15it/s]Pre-processing:  22%|██▏       | 1744/7985 [00:02<00:08, 778.33it/s]Pre-processing:  23%|██▎       | 1824/7985 [00:02<00:07, 776.69it/s]Pre-processing:  24%|██▍       | 1903/7985 [00:02<00:07, 777.63it/s]Pre-processing:  25%|██▍       | 1982/7985 [00:02<00:07, 777.44it/s]Pre-processing:  26%|██▌       | 2061/7985 [00:02<00:07, 765.39it/s]Pre-processing:  27%|██▋       | 2139/7985 [00:02<00:07, 768.27it/s]Pre-processing:  28%|██▊       | 2217/7985 [00:02<00:07, 769.61it/s]Pre-processing:  29%|██▉       | 2297/7985 [00:02<00:07, 777.47it/s]Pre-processing:  30%|██▉       | 2375/7985 [00:03<00:07, 776.91it/s]Pre-processing:  31%|███       | 2453/7985 [00:03<00:07, 774.51it/s]Pre-processing:  32%|███▏      | 2531/7985 [00:03<00:07, 776.08it/s]Pre-processing:  33%|███▎      | 2609/7985 [00:03<00:06, 776.38it/s]Pre-processing:  34%|███▎      | 2687/7985 [00:03<00:06, 775.92it/s]Pre-processing:  35%|███▍      | 2765/7985 [00:03<00:06, 766.83it/s]Pre-processing:  36%|███▌      | 2842/7985 [00:03<00:06, 767.58it/s]Pre-processing:  37%|███▋      | 2919/7985 [00:03<00:06, 767.20it/s]Pre-processing:  38%|███▊      | 2997/7985 [00:03<00:06, 768.33it/s]Pre-processing:  38%|███▊      | 3074/7985 [00:03<00:06, 767.33it/s]Pre-processing:  39%|███▉      | 3151/7985 [00:04<00:06, 767.58it/s]Pre-processing:  40%|████      | 3228/7985 [00:04<00:06, 765.61it/s]Pre-processing:  41%|████▏     | 3306/7985 [00:04<00:06, 769.52it/s]Pre-processing:  42%|████▏     | 3385/7985 [00:04<00:05, 772.98it/s]Pre-processing:  43%|████▎     | 3463/7985 [00:04<00:05, 771.61it/s]Pre-processing:  44%|████▍     | 3541/7985 [00:04<00:05, 771.55it/s]Pre-processing:  45%|████▌     | 3619/7985 [00:04<00:05, 761.55it/s]Pre-processing:  46%|████▋     | 3697/7985 [00:04<00:05, 765.42it/s]Pre-processing:  47%|████▋     | 3774/7985 [00:04<00:07, 600.61it/s]Pre-processing:  48%|████▊     | 3851/7985 [00:05<00:06, 640.86it/s]Pre-processing:  49%|████▉     | 3928/7985 [00:05<00:06, 673.40it/s]Pre-processing:  50%|█████     | 4005/7985 [00:05<00:05, 698.52it/s]Pre-processing:  51%|█████     | 4084/7985 [00:05<00:05, 722.06it/s]Pre-processing:  52%|█████▏    | 4162/7985 [00:05<00:05, 736.05it/s]Pre-processing:  53%|█████▎    | 4241/7985 [00:05<00:04, 749.05it/s]Pre-processing:  54%|█████▍    | 4318/7985 [00:05<00:04, 753.88it/s]Pre-processing:  55%|█████▌    | 4395/7985 [00:05<00:04, 757.04it/s]Pre-processing:  56%|█████▌    | 4472/7985 [00:05<00:04, 760.17it/s]Pre-processing:  57%|█████▋    | 4550/7985 [00:05<00:04, 763.31it/s]Pre-processing:  58%|█████▊    | 4627/7985 [00:06<00:04, 749.82it/s]Pre-processing:  59%|█████▉    | 4704/7985 [00:06<00:04, 754.87it/s]Pre-processing:  60%|█████▉    | 4781/7985 [00:06<00:04, 757.90it/s]Pre-processing:  61%|██████    | 4857/7985 [00:06<00:04, 758.41it/s]Pre-processing:  62%|██████▏   | 4934/7985 [00:06<00:04, 759.85it/s]Pre-processing:  63%|██████▎   | 5011/7985 [00:06<00:03, 760.75it/s]Pre-processing:  64%|██████▎   | 5088/7985 [00:06<00:03, 760.90it/s]Pre-processing:  65%|██████▍   | 5165/7985 [00:06<00:03, 760.57it/s]Pre-processing:  66%|██████▌   | 5242/7985 [00:06<00:03, 761.55it/s]Pre-processing:  67%|██████▋   | 5320/7985 [00:06<00:03, 764.27it/s]Pre-processing:  68%|██████▊   | 5398/7985 [00:07<00:03, 766.38it/s]Pre-processing:  69%|██████▊   | 5475/7985 [00:07<00:03, 763.19it/s]Pre-processing:  70%|██████▉   | 5552/7985 [00:07<00:03, 756.92it/s]Pre-processing:  70%|███████   | 5629/7985 [00:07<00:03, 759.04it/s]Pre-processing:  71%|███████▏  | 5706/7985 [00:07<00:02, 759.96it/s]Pre-processing:  72%|███████▏  | 5783/7985 [00:07<00:02, 761.78it/s]Pre-processing:  73%|███████▎  | 5860/7985 [00:07<00:02, 763.82it/s]Pre-processing:  74%|███████▍  | 5937/7985 [00:07<00:02, 761.90it/s]Pre-processing:  75%|███████▌  | 6014/7985 [00:07<00:02, 761.90it/s]Pre-processing:  76%|███████▋  | 6092/7985 [00:07<00:02, 765.54it/s]Pre-processing:  77%|███████▋  | 6169/7985 [00:08<00:03, 570.43it/s]Pre-processing:  78%|███████▊  | 6246/7985 [00:08<00:02, 618.00it/s]Pre-processing:  79%|███████▉  | 6323/7985 [00:08<00:02, 655.79it/s]Pre-processing:  80%|████████  | 6400/7985 [00:08<00:02, 685.36it/s]Pre-processing:  81%|████████  | 6476/7985 [00:08<00:02, 703.44it/s]Pre-processing:  82%|████████▏ | 6553/7985 [00:08<00:01, 721.59it/s]Pre-processing:  83%|████████▎ | 6629/7985 [00:08<00:01, 731.40it/s]Pre-processing:  84%|████████▍ | 6704/7985 [00:08<00:01, 729.50it/s]Pre-processing:  85%|████████▍ | 6780/7985 [00:09<00:01, 737.68it/s]Pre-processing:  86%|████████▌ | 6856/7985 [00:09<00:01, 742.05it/s]Pre-processing:  87%|████████▋ | 6932/7985 [00:09<00:01, 744.56it/s]Pre-processing:  88%|████████▊ | 7008/7985 [00:09<00:01, 746.32it/s]Pre-processing:  89%|████████▊ | 7085/7985 [00:09<00:01, 751.60it/s]Pre-processing:  90%|████████▉ | 7161/7985 [00:09<00:01, 752.23it/s]Pre-processing:  91%|█████████ | 7237/7985 [00:09<00:00, 752.63it/s]Pre-processing:  92%|█████████▏| 7313/7985 [00:09<00:00, 752.22it/s]Pre-processing:  93%|█████████▎| 7389/7985 [00:09<00:00, 752.12it/s]Pre-processing:  93%|█████████▎| 7465/7985 [00:09<00:00, 747.06it/s]Pre-processing:  94%|█████████▍| 7540/7985 [00:10<00:00, 747.54it/s]Pre-processing:  95%|█████████▌| 7615/7985 [00:10<00:00, 748.02it/s]Pre-processing:  96%|█████████▋| 7690/7985 [00:10<00:00, 745.07it/s]Pre-processing:  97%|█████████▋| 7766/7985 [00:10<00:00, 749.43it/s]Pre-processing:  98%|█████████▊| 7842/7985 [00:10<00:00, 752.25it/s]Pre-processing:  99%|█████████▉| 7918/7985 [00:10<00:00, 753.92it/s]Pre-processing: 100%|██████████| 7985/7985 [00:10<00:00, 752.85it/s]
Filtered graphs type 1/2:  149 5
Filtered graphs:  154
Saving...
Generating 998 graphs for the VAL set...
Pre-processing:   0%|          | 0/998 [00:00<?, ?it/s]Pre-processing:   7%|▋         | 73/998 [00:00<00:01, 720.19it/s]Pre-processing:  15%|█▍        | 147/998 [00:00<00:01, 726.81it/s]Pre-processing:  22%|██▏       | 221/998 [00:00<00:01, 730.63it/s]Pre-processing:  30%|██▉       | 297/998 [00:00<00:00, 739.71it/s]Pre-processing:  37%|███▋      | 371/998 [00:00<00:00, 721.13it/s]Pre-processing:  44%|████▍     | 444/998 [00:00<00:00, 722.84it/s]Pre-processing:  52%|█████▏    | 517/998 [00:00<00:00, 720.53it/s]Pre-processing:  59%|█████▉    | 590/998 [00:00<00:00, 714.68it/s]Pre-processing:  66%|██████▋   | 663/998 [00:00<00:00, 718.94it/s]Pre-processing:  74%|███████▍  | 738/998 [00:01<00:00, 727.64it/s]Pre-processing:  81%|████████▏ | 811/998 [00:01<00:00, 709.18it/s]Pre-processing:  89%|████████▊ | 885/998 [00:01<00:00, 716.99it/s]Pre-processing:  96%|█████████▌| 958/998 [00:01<00:00, 719.28it/s]Pre-processing: 100%|██████████| 998/998 [00:01<00:00, 721.38it/s]
Filtered graphs type 1/2:  0 2
Filtered graphs:  2
Saving...
Generating 999 graphs for the TEST set...
Pre-processing:   0%|          | 0/999 [00:00<?, ?it/s]Pre-processing:   8%|▊         | 75/999 [00:00<00:01, 740.47it/s]Pre-processing:  15%|█▌        | 150/999 [00:00<00:01, 740.60it/s]Pre-processing:  23%|██▎       | 225/999 [00:00<00:01, 740.44it/s]Pre-processing:  30%|███       | 300/999 [00:00<00:00, 741.35it/s]Pre-processing:  38%|███▊      | 375/999 [00:00<00:00, 742.97it/s]Pre-processing:  45%|████▌     | 450/999 [00:00<00:00, 739.76it/s]Pre-processing:  52%|█████▏    | 524/999 [00:00<00:00, 718.37it/s]Pre-processing:  60%|█████▉    | 596/999 [00:00<00:00, 707.96it/s]Pre-processing:  67%|██████▋   | 667/999 [00:00<00:00, 694.28it/s]Pre-processing:  74%|███████▍  | 737/999 [00:01<00:00, 682.36it/s]Pre-processing:  81%|████████  | 806/999 [00:01<00:00, 608.71it/s]Pre-processing:  88%|████████▊ | 876/999 [00:01<00:00, 631.66it/s]Pre-processing:  95%|█████████▍| 949/999 [00:01<00:00, 657.18it/s]Pre-processing: 100%|██████████| 999/999 [00:01<00:00, 687.89it/s]
Filtered graphs type 1/2:  0 3
Filtered graphs:  3
Saving...
train, test, val sizes : 7831 996 996
Time taken: 14.6438s
Bases total: 6
#Params: 499681
Epoch 1 training...
Train iteration:   0%|          | 0/123 [00:00<?, ?it/s]Train iteration:   0%|          | 0/123 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/mingqi/workspace/spectral_rotation/aqsol/graphml/zinc/./main.py", line 293, in <module>
    main()
  File "/home/mingqi/workspace/spectral_rotation/aqsol/graphml/zinc/./main.py", line 113, in main
    epoch_idx, train_curve, valid_curve, test_curve, trainL_curve = run_with_given_seed(config, ts_fk_algo_hp)
  File "/home/mingqi/workspace/spectral_rotation/aqsol/graphml/zinc/./main.py", line 240, in run_with_given_seed
    train_loss = train(model, device, train_loader, optimizer)
  File "/home/mingqi/workspace/spectral_rotation/aqsol/graphml/zinc/./main.py", line 39, in train
    pred = model(bg, x, edge_attr, bases)
  File "/home/mingqi/anaconda3/envs/pytorch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/mingqi/workspace/spectral_rotation/aqsol/graphml/zinc/model.py", line 54, in forward
    x = self.atom_encoder(x)
  File "/home/mingqi/anaconda3/envs/pytorch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/mingqi/anaconda3/envs/pytorch/lib/python3.9/site-packages/torch/nn/modules/sparse.py", line 160, in forward
    return F.embedding(
  File "/home/mingqi/anaconda3/envs/pytorch/lib/python3.9/site-packages/torch/nn/functional.py", line 2210, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
IndexError: index out of range in self
