{'dataset_name': 'DD', 'basis': 'GSO', 'epsilon': [-0.2, -0.25], 'power': [[1, 5], [1, 5]], 'seeds': [0], 'num_folds': 10, 'num_workers': 8, 'hyperparams': {'batch_size': 64, 'epochs': 301, 'learning_rate': 0.001, 'step_size': 50, 'decay_rate': 0.6}, 'architecture': {'nonlinear': 'GELU', 'layers': 6, 'hidden': 256, 'pooling': 'X', 'dropout': 0}, 'commit_id': '62ffe4f61e26add52114c16e87be225fd79dad78', 'time_stamp': '1673354548', 'directory': '../../../../results_spectral_rotation/Try_A100/tu/DD/board/'}
{'dataset_name': 'DD', 'basis': 'GSO', 'epsilon': [-0.2, -0.25], 'power': [[1, 5], [1, 5]], 'seeds': [0], 'num_folds': 10, 'num_workers': 8, 'hyperparams': {'batch_size': 64, 'epochs': 301, 'learning_rate': 0.001, 'step_size': 50, 'decay_rate': 0.6}, 'architecture': {'nonlinear': 'GELU', 'layers': 6, 'hidden': 256, 'pooling': 'X', 'dropout': 0}, 'commit_id': '62ffe4f61e26add52114c16e87be225fd79dad78', 'time_stamp': 1673354549, 'directory': '../../../../results_spectral_rotation/Try_A100/tu/DD/board/', 'seed': 0}
Downloading ./dataset/DD.zip from https://www.chrsmrrs.com/graphkerneldatasets/DD.zip...
Extracting file to ./dataset/DD
No Node Attribute Data
Pre-process:   0%|          | 0/1178 [00:00<?, ?it/s]Pre-process:   1%|          | 6/1178 [00:23<1:18:00,  3.99s/it]Pre-process:   1%|          | 7/1178 [00:24<1:06:11,  3.39s/it]Pre-process:   1%|          | 12/1178 [00:24<27:59,  1.44s/it] Pre-process:   2%|▏         | 20/1178 [00:25<12:07,  1.59it/s]Pre-process:   2%|▏         | 20/1178 [00:40<12:07,  1.59it/s]Pre-process:   2%|▏         | 21/1178 [01:21<1:52:17,  5.82s/it]Pre-process:   2%|▏         | 22/1178 [01:22<1:39:24,  5.16s/it]Pre-process:   2%|▏         | 29/1178 [01:22<45:48,  2.39s/it]  Pre-process:   3%|▎         | 34/1178 [01:22<29:36,  1.55s/it]Pre-process:   3%|▎         | 39/1178 [01:22<19:42,  1.04s/it]Pre-process:   4%|▎         | 44/1178 [01:22<13:26,  1.41it/s]Pre-process:   4%|▍         | 51/1178 [01:22<08:14,  2.28it/s]Pre-process:   5%|▍         | 56/1178 [01:22<06:01,  3.10it/s]Pre-process:   5%|▌         | 63/1178 [01:22<03:54,  4.76it/s]Pre-process:   6%|▌         | 68/1178 [01:23<03:03,  6.06it/s]Pre-process:   6%|▌         | 73/1178 [01:23<02:19,  7.95it/s]Pre-process:   7%|▋         | 79/1178 [01:23<01:58,  9.30it/s]Pre-process:   7%|▋         | 86/1178 [01:23<01:21, 13.35it/s]Pre-process:   8%|▊         | 91/1178 [01:23<01:05, 16.53it/s]Pre-process:   8%|▊         | 96/1178 [01:24<00:56, 19.17it/s]Pre-process:   9%|▊         | 102/1178 [01:24<00:45, 23.80it/s]Pre-process:   9%|▉         | 107/1178 [01:24<00:40, 26.38it/s]Pre-process:  10%|▉         | 112/1178 [01:24<00:36, 29.27it/s]Pre-process:  10%|█         | 118/1178 [01:24<00:31, 34.13it/s]Pre-process:  11%|█         | 124/1178 [01:24<00:26, 39.43it/s]Pre-process:  12%|█▏        | 136/1178 [01:24<00:20, 51.67it/s]Pre-process:  12%|█▏        | 142/1178 [01:24<00:19, 52.05it/s]Pre-process:  13%|█▎        | 148/1178 [01:25<00:19, 53.74it/s]Pre-process:  13%|█▎        | 155/1178 [01:25<00:20, 48.90it/s]Pre-process:  14%|█▎        | 161/1178 [01:25<00:28, 35.34it/s]Pre-process:  14%|█▍        | 166/1178 [01:25<00:28, 35.19it/s]Pre-process:  15%|█▌        | 177/1178 [01:25<00:20, 48.10it/s]Pre-process:  16%|█▌        | 184/1178 [01:25<00:18, 52.73it/s]Pre-process:  16%|█▌        | 190/1178 [01:26<00:25, 38.44it/s]Pre-process:  17%|█▋        | 195/1178 [01:26<00:24, 39.95it/s]Pre-process:  17%|█▋        | 200/1178 [01:31<04:36,  3.53it/s]Pre-process:  17%|█▋        | 204/1178 [01:31<03:41,  4.40it/s]Pre-process:  18%|█▊        | 208/1178 [01:31<03:02,  5.32it/s]Pre-process:  19%|█▊        | 219/1178 [01:32<01:37,  9.82it/s]Pre-process:  19%|█▉        | 225/1178 [01:32<01:15, 12.69it/s]Pre-process:  20%|█▉        | 230/1178 [01:32<01:01, 15.34it/s]Pre-process:  20%|█▉        | 235/1178 [01:32<00:52, 17.79it/s]Pre-process:  20%|██        | 240/1178 [01:32<00:44, 21.28it/s]Pre-process:  21%|██        | 245/1178 [01:33<01:09, 13.47it/s]Pre-process:  21%|██        | 250/1178 [01:33<00:55, 16.82it/s]Pre-process:  22%|██▏       | 254/1178 [01:33<00:49, 18.66it/s]Pre-process:  22%|██▏       | 261/1178 [01:33<00:39, 23.40it/s]Pre-process:  23%|██▎       | 268/1178 [01:33<00:37, 24.12it/s]Pre-process:  23%|██▎       | 272/1178 [01:34<00:34, 26.14it/s]Pre-process:  24%|██▎       | 278/1178 [01:34<00:30, 29.99it/s]Pre-process:  24%|██▍       | 282/1178 [01:34<00:31, 28.53it/s]Pre-process:  24%|██▍       | 288/1178 [01:34<00:26, 34.01it/s]Pre-process:  25%|██▍       | 294/1178 [01:35<00:45, 19.51it/s]Pre-process:  25%|██▌       | 299/1178 [01:35<00:37, 23.34it/s]Pre-process:  26%|██▌       | 303/1178 [01:35<00:34, 25.33it/s]Pre-process:  26%|██▋       | 310/1178 [01:35<00:29, 29.70it/s]Pre-process:  27%|██▋       | 314/1178 [01:35<00:28, 29.80it/s]Pre-process:  27%|██▋       | 318/1178 [01:35<00:44, 19.29it/s]Pre-process:  27%|██▋       | 323/1178 [01:36<00:37, 22.96it/s]Pre-process:  28%|██▊       | 330/1178 [01:36<00:28, 29.51it/s]Pre-process:  29%|██▉       | 339/1178 [01:36<00:20, 40.30it/s]Pre-process:  30%|██▉       | 348/1178 [01:36<00:16, 50.06it/s]Pre-process:  30%|███       | 355/1178 [01:37<00:36, 22.63it/s]Pre-process:  31%|███       | 360/1178 [01:37<00:33, 24.29it/s]Pre-process:  31%|███▏      | 369/1178 [01:37<00:24, 33.11it/s]Pre-process:  32%|███▏      | 375/1178 [01:37<00:24, 32.66it/s]Pre-process:  33%|███▎      | 384/1178 [01:37<00:19, 41.44it/s]Pre-process:  33%|███▎      | 390/1178 [01:37<00:19, 40.66it/s]Pre-process:  34%|███▎      | 397/1178 [01:38<00:18, 42.69it/s]Pre-process:  34%|███▍      | 406/1178 [01:38<00:14, 52.09it/s]Pre-process:  35%|███▌      | 413/1178 [01:38<00:19, 38.46it/s]Pre-process:  36%|███▌      | 423/1178 [01:38<00:15, 47.37it/s]Pre-process:  37%|███▋      | 433/1178 [01:38<00:13, 54.12it/s]Pre-process:  37%|███▋      | 441/1178 [01:38<00:14, 49.65it/s]Pre-process:  38%|███▊      | 447/1178 [01:39<00:16, 44.11it/s]Pre-process:  38%|███▊      | 452/1178 [01:39<00:19, 37.28it/s]Pre-process:  39%|███▉      | 460/1178 [01:39<00:16, 42.86it/s]Pre-process:  40%|███▉      | 468/1178 [01:39<00:14, 49.48it/s]Pre-process:  40%|████      | 474/1178 [01:39<00:13, 51.15it/s]Pre-process:  41%|████      | 480/1178 [01:39<00:14, 48.31it/s]Pre-process:  41%|████▏     | 486/1178 [01:40<00:20, 33.50it/s]Pre-process:  42%|████▏     | 491/1178 [01:40<00:23, 29.13it/s]Pre-process:  42%|████▏     | 495/1178 [01:40<00:28, 24.12it/s]Pre-process:  42%|████▏     | 498/1178 [01:40<00:37, 18.14it/s]Pre-process:  43%|████▎     | 504/1178 [01:41<00:28, 24.07it/s]Pre-process:  43%|████▎     | 508/1178 [01:41<00:30, 21.94it/s]Pre-process:  44%|████▎     | 513/1178 [01:43<01:31,  7.27it/s]Pre-process:  44%|████▍     | 516/1178 [01:43<01:17,  8.52it/s]Pre-process:  44%|████▍     | 519/1178 [01:43<01:06,  9.98it/s]Pre-process:  44%|████▍     | 522/1178 [01:43<00:57, 11.34it/s]Pre-process:  45%|████▍     | 528/1178 [01:43<00:39, 16.40it/s]Pre-process:  45%|████▌     | 533/1178 [01:43<00:31, 20.71it/s]Pre-process:  46%|████▌     | 539/1178 [01:43<00:24, 26.27it/s]Pre-process:  47%|████▋     | 551/1178 [01:43<00:14, 42.94it/s]Pre-process:  47%|████▋     | 558/1178 [01:44<00:17, 36.09it/s]Pre-process:  48%|████▊     | 571/1178 [01:44<00:11, 52.83it/s]Pre-process:  49%|████▉     | 579/1178 [01:44<00:14, 41.84it/s]Pre-process:  50%|████▉     | 587/1178 [01:44<00:12, 45.76it/s]Pre-process:  50%|█████     | 594/1178 [01:44<00:11, 50.05it/s]Pre-process:  51%|█████     | 601/1178 [01:44<00:12, 48.04it/s]Pre-process:  52%|█████▏    | 611/1178 [01:45<00:10, 55.36it/s]Pre-process:  52%|█████▏    | 618/1178 [01:45<00:11, 50.00it/s]Pre-process:  53%|█████▎    | 624/1178 [01:45<00:12, 44.50it/s]Pre-process:  53%|█████▎    | 629/1178 [01:45<00:12, 45.13it/s]Pre-process:  54%|█████▍    | 637/1178 [01:45<00:12, 42.70it/s]Pre-process:  55%|█████▍    | 645/1178 [01:45<00:13, 38.39it/s]Pre-process:  55%|█████▌    | 651/1178 [01:46<00:13, 39.13it/s]Pre-process:  56%|█████▌    | 658/1178 [01:46<00:14, 37.06it/s]Pre-process:  57%|█████▋    | 666/1178 [01:46<00:11, 44.89it/s]Pre-process:  57%|█████▋    | 673/1178 [01:46<00:10, 48.71it/s]Pre-process:  58%|█████▊    | 679/1178 [01:46<00:10, 45.83it/s]Pre-process:  58%|█████▊    | 684/1178 [01:46<00:14, 34.97it/s]Pre-process:  58%|█████▊    | 689/1178 [01:47<00:15, 31.53it/s]Pre-process:  59%|█████▉    | 695/1178 [01:47<00:13, 36.61it/s]Pre-process:  61%|██████▏   | 724/1178 [01:47<00:05, 87.19it/s]Pre-process:  63%|██████▎   | 738/1178 [01:47<00:05, 79.87it/s]Pre-process:  65%|██████▍   | 761/1178 [01:47<00:04, 98.44it/s]Pre-process:  66%|██████▌   | 779/1178 [01:47<00:03, 113.02it/s]Pre-process:  68%|██████▊   | 800/1178 [01:48<00:03, 113.83it/s]Pre-process:  69%|██████▉   | 813/1178 [01:48<00:03, 98.28it/s] Pre-process:  70%|██████▉   | 824/1178 [01:48<00:04, 87.73it/s]Pre-process:  71%|███████   | 834/1178 [01:48<00:03, 88.16it/s]Pre-process:  72%|███████▏  | 844/1178 [01:48<00:03, 90.48it/s]Pre-process:  72%|███████▏  | 854/1178 [01:48<00:03, 87.17it/s]Pre-process:  74%|███████▎  | 867/1178 [01:48<00:03, 96.79it/s]Pre-process:  75%|███████▍  | 880/1178 [01:49<00:03, 91.18it/s]Pre-process:  76%|███████▌  | 890/1178 [01:49<00:04, 71.43it/s]Pre-process:  77%|███████▋  | 912/1178 [01:49<00:02, 102.20it/s]Pre-process:  79%|███████▉  | 931/1178 [01:49<00:02, 120.53it/s]Pre-process:  80%|████████  | 946/1178 [01:49<00:01, 127.63it/s]Pre-process:  82%|████████▏ | 961/1178 [01:49<00:01, 126.78it/s]Pre-process:  83%|████████▎ | 975/1178 [01:49<00:01, 104.67it/s]Pre-process:  84%|████████▍ | 993/1178 [01:50<00:01, 111.78it/s]Pre-process:  85%|████████▌ | 1006/1178 [01:50<00:01, 88.11it/s]Pre-process:  87%|████████▋ | 1027/1178 [01:50<00:01, 112.08it/s]Pre-process:  88%|████████▊ | 1041/1178 [01:50<00:01, 116.00it/s]Pre-process:  90%|████████▉ | 1055/1178 [01:50<00:01, 104.33it/s]Pre-process:  91%|█████████ | 1067/1178 [01:50<00:01, 89.12it/s] Pre-process:  92%|█████████▏| 1078/1178 [01:51<00:01, 62.87it/s]Pre-process:  93%|█████████▎| 1098/1178 [01:51<00:00, 84.30it/s]Pre-process:  95%|█████████▌| 1124/1178 [01:51<00:00, 116.68it/s]Pre-process:  98%|█████████▊| 1150/1178 [01:51<00:00, 147.10it/s]Pre-process:  99%|█████████▉| 1169/1178 [01:51<00:00, 154.19it/s]Pre-process: 100%|██████████| 1178/1178 [01:51<00:00, 10.55it/s] 
Basis total: 11
train_set : test_set = %d : %d 1060 118
-------- FOLD0 DATASET=DD, COMMIT_ID=62ffe4f61e26add52114c16e87be225fd79dad78
With batch_norm.
With edge_softmax.
#Params: 1349634
Traceback (most recent call last):
  File "/home/mingqi/workspace/spectral_rotation/tu/graphml/tu/./main.py", line 266, in <module>
    main()
  File "/home/mingqi/workspace/spectral_rotation/tu/graphml/tu/./main.py", line 262, in main
    run_model(config)
  File "/home/mingqi/workspace/spectral_rotation/tu/graphml/tu/./main.py", line 195, in run_model
    test_accs, train_losses, train_accs = run_given_fold(
  File "/home/mingqi/workspace/spectral_rotation/tu/graphml/tu/./main.py", line 97, in run_given_fold
    train_loss = train(model, optimizer, train_loader, criterion, device)
  File "/home/mingqi/workspace/spectral_rotation/tu/graphml/tu/./main.py", line 37, in train
    outputs = model(batch_graphs, feat, bases)
  File "/home/mingqi/anaconda3/envs/pytorch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/mingqi/workspace/spectral_rotation/tu/graphml/tu/model.py", line 77, in forward
    bases = self.filter_drop(self.filter_encoder(bases))
  File "/home/mingqi/anaconda3/envs/pytorch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/mingqi/anaconda3/envs/pytorch/lib/python3.9/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/mingqi/anaconda3/envs/pytorch/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/mingqi/anaconda3/envs/pytorch/lib/python3.9/site-packages/torch/nn/modules/activation.py", line 684, in forward
    return F.gelu(input, approximate=self.approximate)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 7.16 GiB (GPU 0; 39.41 GiB total capacity; 36.26 GiB already allocated; 1.81 GiB free; 36.28 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
